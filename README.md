# OCR GUI Application with PaddleOCR ～pdf2xlsx～

## プロジェクト概要
このアプリケーションは、セル形式のpdfファイルからテキストを抽出し、結果をExcelにまとめるGUIツールです。  
業務でのOCR処理をより直感的に行えるように設計しました。
このプロジェクトは現在も進行中のもので、最新のアプリケーションはGUIをC#で実装し、それ以外の処理をPythonで実装していますが、
最新版をお見せすることは叶いませんので、このリポジトリではGUI部分をC#に移植する前のtkinterによる実装を公開します。
あらかじめご了承ください。

## 技術スタック
- **言語**: Python
- **GUI**: tkinter
- **OCRエンジン**: PaddleOCR
- **処理環境**: 外部GPUサーバー（https経由で接続）
- **出力**: Excel (pandas, openpyxl)

## 大まかな処理の流れ
- GUIからpdfファイルを選択し、処理を開始
- 選択したファイルに適切な処理を施したうえで企業のオンプレGPUサーバーにhttps接続し、OCRの処理はGPUマシン上で行う
- 抽出結果をjsonでクライアントに返却し、間違って抽出した可能性のある文字列をGUI上で手動で編集可能
- 編集が終わったらExcelへ出力を行い、一連の処理が完了

## 各ファイルについての説明
- **pdf2xlsx.py**: こちらがメインのスクリプトで、主にGUI部分をtkinterで実装しています。
- **pdf2df.py**: 内部の処理をこの関数で主に行います。GPUマシンで処理を行うための前処理、GPUマシンから受け取ったjsonを正規化するなどの処理を行います。
- **tools.py**: pdfを画像に変換するといった、OCR処理に直接的な関わりのないヘルパー関数をクラス化したスクリプトです。
- **normarization.py**: pdf2df.pyにおいてデータフレーム化した構造に対し、主に文字列に対する正規化を行います。
- **evaluation.py**: このアプリケーションの性能をOCRの観点から評価するスクリプトです。
プレゼンの機会など、第三者に発表するためにこのスクリプトを作成していますので、アプリの挙動に直接的な影響はございません。
evaluation.pyには2つの評価関数を用意しており、その結果を以下の画像で示します。



## 外部マシンについて
一緒にプロジェクトを進めている企業様にオンプレのGPUマシンを用意していただき、そのマシンをPythonのfastapiを用いて
APIサーバ化し、アプリケーションとhttps通信によりAPI通信を行えるようにしました。
GPUマシン上にDocker Engineをインストールし、fastapi、nginx、PaddleOCRのコンテナをcomposeするdocker composeファイルを作成することで
それを動かすことによってAPIサーバ化の実現に至りました。
基本的に企業様の社内ネットワーク内での通信にとどまるので、一旦は簡単のためにnginx内のssl証明書はopen-sslによる自己署名証明書を用いていますが、
よりセキュアな構成にするために企業様にドメインを取得していただき、そのドメインを用いてLet's Encryptにssl証明書を発行してもらうことを現在検討中です。

